!function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=3)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PistolFactory=e.Pistol=void 0;var n=function(){function t(t){var e=t.pistol,o=t.objectFactory;this.lastFired=0,this.pistol=e,this.objectFactory=o}return t.prototype.setActivate=function(t){this.pistol.setVisible(t)},t.prototype.fire=function(t,e,o,n){if(t>this.lastFired){var r=i.shotSprites[Math.floor(5*Math.random())],a=this.objectFactory.sprite(o,n,r);a.play(r),a.once(Phaser.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){return a.destroy()})),this.lastFired=t+800}},t}();e.Pistol=n;var i=function(){function t(){}return t.load=function(e){e.load.image(t.pistol,t.pistol);for(var o=0,n=t.shotSprites;o<n.length;o++){var i=n[o];e.load.spritesheet(i,i,{frameWidth:32,frameHeight:32,endFrame:3})}},t.create=function(e,o){t.shotSprites.map((function(t){return e.createAnimation({key:t,frames:e.anims.generateFrameNames(t),hideOnComplete:!0})}));var i=e.add.sprite(12,-10,t.pistol).setVisible(!1);return o.add(i),new n({objectFactory:e.add,pistol:i})},t.pistol="assets/pistol.png",t.shotSprites=["assets/pistol-shot.png","assets/pistol-shot-up.png","assets/pistol-shot-right.png","assets/pistol-shot-bottom.png","assets/pistol-shot-left.png"],t}();e.PistolFactory=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RocketGunFactory=e.RocketGun=void 0;var n=o(2),i=function(){function t(t){var e=t.rocketGun,o=t.rocketGroup;this.lastFired=0,this.rocketGun=e,this.rocketGroup=o}return t.prototype.setActivate=function(t){this.rocketGun.setVisible(t)},t.prototype.fire=function(t,e,o,n){if(t>this.lastFired){var i=this.rocketGroup.get();if(i){var r=this.getAbsolutePosition(),a=r[0],s=r[1];i.activate(a,s,o,n),this.lastFired=t+600}}},t.prototype.getAbsolutePosition=function(){this.rocketGun.getWorldTransformMatrix(t.tempMatrix);var e=t.tempMatrix.decomposeMatrix();return[e.translateX,e.translateY]},t.tempMatrix=new Phaser.GameObjects.Components.TransformMatrix,t}();e.RocketGun=i;var r=function(){function t(){}return t.load=function(e){e.load.image({key:t.image,url:t.image})},t.create=function(e,o){var r=e.add.group({classType:n.Rocket,maxSize:20,runChildUpdate:!0}),a=e.add.sprite(12,-7,t.image).setVisible(!1);return o.add(a),new i({rocketGun:a,rocketGroup:r})},t.image="assets/rocket-gun.png",t}();e.RocketGunFactory=r},function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.RocketFactory=e.Rocket=void 0;var r=function(t){function e(e){var o=t.call(this,e,0,0,a.rocketImage)||this;return o.displayHeight=7,o.displayWidth=15,o.incX=0,o.incY=0,o.speed=Phaser.Math.GetSpeed(400,1),o}return i(e,t),e.prototype.activate=function(t,e,o,n){this.x1=t,this.y1=e,this.x2=o,this.y2=n,this.setActive(!0),this.setVisible(!0),this.setPosition(t,e);var i=Phaser.Math.Angle.Between(o,n,t,e);this.setRotation(i),this.incX=Math.cos(i),this.incY=Math.sin(i)},e.prototype.update=function(t,e){if(this.x-=this.incX*(this.speed*e),this.y-=this.incY*(this.speed*e),Math.abs(this.x2-this.x1)-Math.abs(this.x-this.x1)<0||Math.abs(this.y2-this.y1)-Math.abs(this.y-this.y1)<0){this.setActive(!1),this.setVisible(!1);var o=this.scene.add.sprite(this.x,this.y,a.explosionSprite);o.setScale(10),o.play(a.explosionSprite),o.once(Phaser.Animations.Events.SPRITE_ANIMATION_COMPLETE,(function(){return o.destroy()})),this.destroy(),console.log("destroy")}},e}(Phaser.GameObjects.Image);e.Rocket=r;var a=function(){function t(){}return t.load=function(e){e.load.image({key:t.rocketImage,url:t.rocketImage}),e.load.spritesheet(t.explosionSprite,t.explosionSprite,{frameWidth:64,frameHeight:64,endFrame:23})},t.addAnimationToScene=function(e){return e.anims.create({key:t.explosionSprite,frames:e.anims.generateFrameNames(t.explosionSprite),hideOnComplete:!0})},t.rocketImage="assets/rocket.png",t.explosionSprite="assets/rocket-explosion.png",t}();e.RocketFactory=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),o(4);var n=o(6),i={type:Phaser.WEBGL,width:800,height:600,backgroundColor:"#2d2d2d",scene:n.Scene};new Phaser.Game(i)},function(t,e,o){t.exports=o(5)(1)},function(t,e){t.exports=vendor},function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0;var r=o(7),a=o(2),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.preload=function(){a.RocketFactory.load(this),r.MandalorianFactory.load(this)},e.prototype.create=function(){a.RocketFactory.addAnimationToScene(this),this.mandalorian=r.MandalorianFactory.create(this)},e.prototype.update=function(t,e){this.mandalorian.update(t,e)},e.prototype.createAnimation=function(t){var e=this.anims.create(t);if(!1===e)throw new Error("Не удалось созать анимацию "+t.key);return e},e}(Phaser.Scene);e.Scene=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MandalorianFactory=e.Mandalorian=void 0;var n=o(8),i=o(0),r=o(1),a=function(){function t(t){var e=t.mandalorian,o=t.weapons,n=t.keyboard,i=t.mouse;this.speed=Phaser.Math.GetSpeed(100,1),this.mandalorian=e,this.weapons=o,this.mouse=i,this.up=[n.addKey("up"),n.addKey("E")],this.left=[n.addKey("left"),n.addKey("S")],this.bottom=[n.addKey("down"),n.addKey("D")],this.right=[n.addKey("right"),n.addKey("F")]}return t.prototype.update=function(t,e){this.weapons.update(t,e),this.mandalorian.x+=e*this.speed*(Number(this.right.some((function(t){return t.isDown})))-Number(this.left.some((function(t){return t.isDown})))),this.mandalorian.y+=e*this.speed*(Number(this.bottom.some((function(t){return t.isDown})))-Number(this.up.some((function(t){return t.isDown})))),this.mandalorian.setRotation(Phaser.Math.Angle.Between(this.mouse.x,this.mouse.y,this.mandalorian.x,this.mandalorian.y)-Math.PI/2)},t}();e.Mandalorian=a;var s=function(){function t(){}return t.load=function(e){i.PistolFactory.load(e),r.RocketGunFactory.load(e),e.load.image(t.mandalorianSprite,"assets/mandalorian.png")},t.create=function(e){var o=e.input.keyboard,i=e.input.mousePointer,r=e.add.sprite(0,0,t.mandalorianSprite),s=e.add.container(400,400,[r]).setDepth(1),c=n.MandalorianWeaponFactory.create(e,s);return new a({mandalorian:s,weapons:c,keyboard:o,mouse:i})},t.mandalorianSprite="mandalorianSprite",t}();e.MandalorianFactory=s},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MandalorianWeaponFactory=e.MandalorianWeapons=void 0;var n=o(0),i=o(1),r=function(){function t(t){var e=this,o=t.pistol,n=t.rocketGun,i=t.input,r=t.mouse;this.activeIndex=0,this.getWeapon=function(){return e.weapons[e.activeIndex]},this.switchWeapons=function(){e.getWeapon().setActivate(!1),e.switchIndex(),e.getWeapon().setActivate(!0)},this.weapons=[o,n],this.mouse=r,i.keyboard.addKey("W").on(Phaser.Input.Keyboard.Events.DOWN,this.switchWeapons),i.keyboard.addKey("CTRL").on(Phaser.Input.Keyboard.Events.DOWN,this.switchWeapons),this.getWeapon().setActivate(!0)}return t.prototype.update=function(t,e){this.mouse.isDown&&this.getWeapon().fire(t,e,this.mouse.x,this.mouse.y)},t.prototype.switchIndex=function(){++this.activeIndex>=this.weapons.length&&(this.activeIndex=0)},t}();e.MandalorianWeapons=r;var a=function(){function t(){}return t.create=function(t,e){var o=t.input,a=t.input.mousePointer,s=n.PistolFactory.create(t,e),c=i.RocketGunFactory.create(t,e);return new r({pistol:s,rocketGun:c,input:o,mouse:a})},t}();e.MandalorianWeaponFactory=a}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL1Bpc3RvbC50cyIsIndlYnBhY2s6Ly8vLi9zcmMvUm9ja2V0R3VuLnRzIiwid2VicGFjazovLy8uL3NyYy9Sb2NrZXQudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL0dhbWUudHMiLCJ3ZWJwYWNrOi8vL2RlbGVnYXRlZCAuL25vZGVfbW9kdWxlcy9waGFzZXIvZGlzdC9waGFzZXIuanMgZnJvbSBkbGwtcmVmZXJlbmNlIHZlbmRvciIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJ2ZW5kb3JcIiIsIndlYnBhY2s6Ly8vLi9zcmMvU2NlbmUudHMiLCJ3ZWJwYWNrOi8vLy4vc3JjL01hbmRhbG9yaWFuLnRzIiwid2VicGFjazovLy8uL3NyYy9NYW5kYWxvcmlhbldlYXBvbnMudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJwaXN0b2wiLCJvYmplY3RGYWN0b3J5IiwibGFzdEZpcmVkIiwidGhpcyIsInNldEFjdGl2YXRlIiwiYWN0aXZhdGVkIiwic2V0VmlzaWJsZSIsImZpcmUiLCJ0aW1lIiwiZGVsdGEiLCJ4IiwieSIsInNwcml0ZU5hbWUiLCJQaXN0b2xGYWN0b3J5Iiwic2hvdFNwcml0ZXMiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJzcHJpdGUiLCJwbGF5Iiwib25jZSIsIlBoYXNlciIsIkFuaW1hdGlvbnMiLCJFdmVudHMiLCJTUFJJVEVfQU5JTUFUSU9OX0NPTVBMRVRFIiwiZGVzdHJveSIsIlBpc3RvbCIsImxvYWQiLCJzY2VuZSIsImltYWdlIiwic3ByaXRlc2hlZXQiLCJmcmFtZVdpZHRoIiwiZnJhbWVIZWlnaHQiLCJlbmRGcmFtZSIsImNvbnRhaW5lciIsIm1hcCIsImNyZWF0ZUFuaW1hdGlvbiIsImZyYW1lcyIsImFuaW1zIiwiZ2VuZXJhdGVGcmFtZU5hbWVzIiwiaGlkZU9uQ29tcGxldGUiLCJhZGQiLCJyb2NrZXRHdW4iLCJyb2NrZXRHcm91cCIsInJvY2tldCIsImdldEFic29sdXRlUG9zaXRpb24iLCJ4MCIsInkwIiwiYWN0aXZhdGUiLCJnZXRXb3JsZFRyYW5zZm9ybU1hdHJpeCIsIlJvY2tldEd1biIsInRlbXBNYXRyaXgiLCJkZWNvbXBvc2VNYXRyaXgiLCJ0cmFuc2xhdGVYIiwidHJhbnNsYXRlWSIsIkdhbWVPYmplY3RzIiwiQ29tcG9uZW50cyIsIlRyYW5zZm9ybU1hdHJpeCIsIlJvY2tldEd1bkZhY3RvcnkiLCJ1cmwiLCJncm91cCIsImNsYXNzVHlwZSIsIlJvY2tldCIsIm1heFNpemUiLCJydW5DaGlsZFVwZGF0ZSIsIlJvY2tldEZhY3RvcnkiLCJyb2NrZXRJbWFnZSIsImRpc3BsYXlIZWlnaHQiLCJkaXNwbGF5V2lkdGgiLCJpbmNYIiwiaW5jWSIsInNwZWVkIiwiR2V0U3BlZWQiLCJ4MSIsInkxIiwieDIiLCJ5MiIsInNldEFjdGl2ZSIsInNldFBvc2l0aW9uIiwiYW5nbGUiLCJBbmdsZSIsIkJldHdlZW4iLCJzZXRSb3RhdGlvbiIsImNvcyIsInNpbiIsInVwZGF0ZSIsImFicyIsImV4cGxvc2lvblNwcml0ZSIsInNldFNjYWxlIiwiY29uc29sZSIsImxvZyIsIkltYWdlIiwiYWRkQW5pbWF0aW9uVG9TY2VuZSIsImNvbmZpZyIsInR5cGUiLCJXRUJHTCIsIndpZHRoIiwiaGVpZ2h0IiwiYmFja2dyb3VuZENvbG9yIiwiU2NlbmUiLCJHYW1lIiwidmVuZG9yIiwicHJlbG9hZCIsIk1hbmRhbG9yaWFuRmFjdG9yeSIsIm1hbmRhbG9yaWFuIiwicmVzdWx0IiwiRXJyb3IiLCJ3ZWFwb25zIiwia2V5Ym9hcmQiLCJtb3VzZSIsInVwIiwiYWRkS2V5IiwibGVmdCIsImJvdHRvbSIsInJpZ2h0IiwiTnVtYmVyIiwic29tZSIsImlzRG93biIsIlBJIiwiTWFuZGFsb3JpYW4iLCJtYW5kYWxvcmlhblNwcml0ZSIsImlucHV0IiwibW91c2VQb2ludGVyIiwic2V0RGVwdGgiLCJNYW5kYWxvcmlhbldlYXBvbkZhY3RvcnkiLCJhY3RpdmVJbmRleCIsImdldFdlYXBvbiIsInN3aXRjaFdlYXBvbnMiLCJzd2l0Y2hJbmRleCIsIm9uIiwiSW5wdXQiLCJLZXlib2FyZCIsIkRPV04iLCJsZW5ndGgiLCJNYW5kYWxvcmlhbldlYXBvbnMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVBQWViLEVBQVMsYUFBYyxDQUFFbUIsT0FBTyxLQVF2RHJCLEVBQW9Cc0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFyQixFQUFvQnFCLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBMUIsRUFBb0JrQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT3JCLEVBQW9CVSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSekIsRUFBb0I2QixFQUFJLFNBQVMxQixHQUNoQyxJQUFJUyxFQUFTVCxHQUFVQSxFQUFPcUIsV0FDN0IsV0FBd0IsT0FBT3JCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFILEVBQW9CVSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSWixFQUFvQmEsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekcvQixFQUFvQmtDLEVBQUksR0FJakJsQyxFQUFvQkEsRUFBb0JtQyxFQUFJLEcsZ0hDekVyRCxpQkFLSSxXQUFZLEcsSUFBQ0MsRUFBTSxTQUFFQyxFQUFhLGdCQUZsQyxLQUFBQyxVQUFZLEVBR1JDLEtBQUtILE9BQVNBLEVBQ2RHLEtBQUtGLGNBQWdCQSxFQWtCN0IsT0FmSSxZQUFBRyxZQUFBLFNBQVlDLEdBQ1JGLEtBQUtILE9BQU9NLFdBQVdELElBRzNCLFlBQUFFLEtBQUEsU0FBS0MsRUFBY0MsRUFBZUMsRUFBV0MsR0FDekMsR0FBSUgsRUFBT0wsS0FBS0QsVUFBVyxDQUN2QixJQUFNVSxFQUFhQyxFQUFjQyxZQUFZQyxLQUFLQyxNQUFzQixFQUFoQkQsS0FBS0UsV0FFdkQsRUFBYWQsS0FBS0YsY0FBY2lCLE9BQU9SLEVBQUdDLEVBQUdDLEdBQ25ELEVBQVdPLEtBQUtQLEdBQ2hCLEVBQVdRLEtBQUtDLE9BQU9DLFdBQVdDLE9BQU9DLDJCQUEyQixXQUFNLFNBQVdDLGFBRXJGdEIsS0FBS0QsVUFBWU0sRUFBTyxNQUdwQyxFQXpCQSxHQUFhLEVBQUFrQixTQTJCYiwrQkE4QkEsT0FuQlcsRUFBQUMsS0FBUCxTQUFZQyxHQUNSQSxFQUFNRCxLQUFLRSxNQUFNaEIsRUFBY2IsT0FBUWEsRUFBY2IsUUFFckQsSUFBbUIsVUFBQWEsRUFBY0MsWUFBZCxlQUF5QixDQUF2QyxJQUFJSSxFQUFNLEtBQ1hVLEVBQU1ELEtBQUtHLFlBQVlaLEVBQVFBLEVBQVEsQ0FBRWEsV0FBWSxHQUFJQyxZQUFhLEdBQUlDLFNBQVUsTUFHckYsRUFBQTNDLE9BQVAsU0FBY3NDLEVBQWNNLEdBQ3hCckIsRUFBY0MsWUFBWXFCLEtBQUksU0FBQWpCLEdBQVUsT0FBQVUsRUFBTVEsZ0JBQWdCLENBQzFEN0MsSUFBSzJCLEVBQ0xtQixPQUFRVCxFQUFNVSxNQUFNQyxtQkFBbUJyQixHQUN2Q3NCLGdCQUFnQixPQUdwQixJQUFNeEMsRUFBUzRCLEVBQU1hLElBQUl2QixPQUFPLElBQUssR0FBSUwsRUFBY2IsUUFBUU0sWUFBVyxHQUcxRSxPQUZBNEIsRUFBVU8sSUFBSXpDLEdBRVAsSUFBSTBCLEVBQU8sQ0FBQ3pCLGNBQWUyQixFQUFNYSxJQUFLekMsT0FBTSxLQTNCdkMsRUFBQUEsT0FBUyxvQkFFVCxFQUFBYyxZQUFjLENBQzFCLHlCQUNBLDRCQUNBLCtCQUNBLGdDQUNBLCtCQXNCUixFQTlCQSxHQUFhLEVBQUFELGlCLG9IQ25DYixXQVFBLGFBT0ksV0FBWSxHLElBQUM2QixFQUFTLFlBQUVDLEVBQVcsY0FGbkMsS0FBQXpDLFVBQVksRUFHUkMsS0FBS3VDLFVBQVlBLEVBQ2pCdkMsS0FBS3dDLFlBQWNBLEVBMEIzQixPQXZCSSxZQUFBdkMsWUFBQSxTQUFZQyxHQUNSRixLQUFLdUMsVUFBVXBDLFdBQVdELElBRzlCLFlBQUFFLEtBQUEsU0FBS0MsRUFBY0MsRUFBZUMsRUFBV0MsR0FDekMsR0FBSUgsRUFBT0wsS0FBS0QsVUFBVyxDQUN2QixJQUFJMEMsRUFBU3pDLEtBQUt3QyxZQUFZOUQsTUFFOUIsR0FBSStELEVBQVEsQ0FDRixNQUFXekMsS0FBSzBDLHNCQUFmQyxFQUFFLEtBQUVDLEVBQUUsS0FFYkgsRUFBT0ksU0FBU0YsRUFBSUMsRUFBSXJDLEVBQUdDLEdBRTNCUixLQUFLRCxVQUFZTSxFQUFPLE9BS3BDLFlBQUFxQyxvQkFBQSxXQUNJMUMsS0FBS3VDLFVBQVVPLHdCQUF3QkMsRUFBVUMsWUFDakQsSUFBSTdFLEVBQUk0RSxFQUFVQyxXQUFXQyxrQkFDN0IsTUFBTyxDQUFDOUUsRUFBRStFLFdBQVkvRSxFQUFFZ0YsYUFoQ3JCLEVBQUFILFdBQWEsSUFBSTlCLE9BQU9rQyxZQUFZQyxXQUFXQyxnQkFrQzFELEVBbkNBLEdBQWEsRUFBQVAsWUFxQ2IsK0JBdUJBLE9BcEJXLEVBQUF2QixLQUFQLFNBQVlDLEdBQ1JBLEVBQU1ELEtBQUtFLE1BQU0sQ0FDYnRDLElBQUttRSxFQUFpQjdCLE1BQ3RCOEIsSUFBS0QsRUFBaUI3QixTQUl2QixFQUFBdkMsT0FBUCxTQUFjc0MsRUFBY00sR0FDeEIsSUFBTVMsRUFBY2YsRUFBTWEsSUFBSW1CLE1BQU0sQ0FDaENDLFVBQVcsRUFBQUMsT0FDWEMsUUFBUyxHQUNUQyxnQkFBZ0IsSUFHZHRCLEVBQVlkLEVBQU1hLElBQUl2QixPQUFPLElBQUssRUFBR3dDLEVBQWlCN0IsT0FBT3ZCLFlBQVcsR0FJOUUsT0FIQTRCLEVBQVVPLElBQUlDLEdBR1AsSUFBSVEsRUFBVSxDQUFDUixVQUFTLEVBQUVDLFlBQVcsS0FwQmhDLEVBQUFkLE1BQVEsd0JBc0I1QixFQXZCQSxHQUFhLEVBQUE2QixvQiw4YkM1Q2Isa0JBVUksV0FBWTlCLEdBQVosTUFDSSxZQUFNQSxFQUFPLEVBQUcsRUFBR3FDLEVBQWNDLGNBQVksSyxPQUU3QyxFQUFLQyxjQUFnQixFQUNyQixFQUFLQyxhQUFlLEdBQ3BCLEVBQUtDLEtBQU8sRUFDWixFQUFLQyxLQUFPLEVBQ1osRUFBS0MsTUFBUWxELE9BQU9OLEtBQUt5RCxTQUFTLElBQUssRyxFQTJDL0MsT0E1RDRCLE9BcUJ4QixZQUFBeEIsU0FBQSxTQUFTeUIsRUFBWUMsRUFBWUMsRUFBWUMsR0FDekN6RSxLQUFLc0UsR0FBS0EsRUFDVnRFLEtBQUt1RSxHQUFLQSxFQUNWdkUsS0FBS3dFLEdBQUtBLEVBQ1Z4RSxLQUFLeUUsR0FBS0EsRUFFVnpFLEtBQUswRSxXQUFVLEdBQ2YxRSxLQUFLRyxZQUFXLEdBRWhCSCxLQUFLMkUsWUFBWUwsRUFBSUMsR0FFckIsSUFBSUssRUFBUTFELE9BQU9OLEtBQUtpRSxNQUFNQyxRQUFRTixFQUFJQyxFQUFJSCxFQUFJQyxHQUVsRHZFLEtBQUsrRSxZQUFZSCxHQUVqQjVFLEtBQUtrRSxLQUFPdEQsS0FBS29FLElBQUlKLEdBQ3JCNUUsS0FBS21FLEtBQU92RCxLQUFLcUUsSUFBSUwsSUFHekIsWUFBQU0sT0FBQSxTQUFPN0UsRUFBY0MsR0FLakIsR0FIQU4sS0FBS08sR0FBS1AsS0FBS2tFLE1BQVFsRSxLQUFLb0UsTUFBUTlELEdBQ3BDTixLQUFLUSxHQUFLUixLQUFLbUUsTUFBUW5FLEtBQUtvRSxNQUFROUQsR0FFaENNLEtBQUt1RSxJQUFJbkYsS0FBS3dFLEdBQUt4RSxLQUFLc0UsSUFBTTFELEtBQUt1RSxJQUFJbkYsS0FBS08sRUFBSVAsS0FBS3NFLElBQU0sR0FDM0QxRCxLQUFLdUUsSUFBSW5GLEtBQUt5RSxHQUFLekUsS0FBS3VFLElBQU0zRCxLQUFLdUUsSUFBSW5GLEtBQUtRLEVBQUlSLEtBQUt1RSxJQUFNLEVBQUcsQ0FDOUR2RSxLQUFLMEUsV0FBVSxHQUNmMUUsS0FBS0csWUFBVyxHQUVoQixJQUFNLEVBQWtCSCxLQUFLeUIsTUFBTWEsSUFBSXZCLE9BQU9mLEtBQUtPLEVBQUdQLEtBQUtRLEVBQUdzRCxFQUFjc0IsaUJBQzVFLEVBQWdCQyxTQUFTLElBQ3pCLEVBQWdCckUsS0FBSzhDLEVBQWNzQixpQkFDbkMsRUFBZ0JuRSxLQUFLQyxPQUFPQyxXQUFXQyxPQUFPQywyQkFBMkIsV0FBTSxTQUFnQkMsYUFFL0Z0QixLQUFLc0IsVUFFTGdFLFFBQVFDLElBQUksYUFHeEIsRUE1REEsQ0FBNEJyRSxPQUFPa0MsWUFBWW9DLE9BQWxDLEVBQUE3QixTQThEYiwrQkFvQkEsT0FoQlcsRUFBQW5DLEtBQVAsU0FBWUMsR0FDUkEsRUFBTUQsS0FBS0UsTUFBTSxDQUNidEMsSUFBSzBFLEVBQWNDLFlBQ25CUCxJQUFLTSxFQUFjQyxjQUd2QnRDLEVBQU1ELEtBQUtHLFlBQVltQyxFQUFjc0IsZ0JBQWlCdEIsRUFBY3NCLGdCQUFpQixDQUFFeEQsV0FBWSxHQUFJQyxZQUFhLEdBQUlDLFNBQVUsTUFHL0gsRUFBQTJELG9CQUFQLFNBQTJCaEUsR0FDdkIsT0FBT0EsRUFBTVUsTUFBTWhELE9BQU8sQ0FDdEJDLElBQUswRSxFQUFjc0IsZ0JBQ25CbEQsT0FBUVQsRUFBTVUsTUFBTUMsbUJBQW1CMEIsRUFBY3NCLGlCQUNyRC9DLGdCQUFnQixLQWhCUixFQUFBMEIsWUFBYyxvQkFDZCxFQUFBcUIsZ0JBQWtCLDhCQWtCdEMsRUFwQkEsR0FBYSxFQUFBdEIsaUIsOEVDaEViLEtBQ0EsV0FFTTRCLEVBQVMsQ0FDWEMsS0FBTXpFLE9BQU8wRSxNQUNiQyxNQUFPLElBQ1BDLE9BQVEsSUFDUkMsZ0JBQWlCLFVBQ2pCdEUsTUFBTyxFQUFBdUUsT0FHRSxJQUFJOUUsT0FBTytFLEtBQUtQLEksZ0JDWDdCOUgsRUFBT0QsUUFBV0YsRUFBb0IsRUFBckIsQ0FBeUIsSSxjQ0ExQ0csRUFBT0QsUUFBVXVJLFEsNmFDQWpCLFdBQ0EsT0FFQSwyQiwrQ0F3QkEsT0F4QjJCLE9BR3ZCLFlBQUFDLFFBQUEsV0FDSSxFQUFBckMsY0FBY3RDLEtBQUt4QixNQUNuQixFQUFBb0csbUJBQW1CNUUsS0FBS3hCLE9BRzVCLFlBQUFiLE9BQUEsV0FDSSxFQUFBMkUsY0FBYzJCLG9CQUFvQnpGLE1BQ2xDQSxLQUFLcUcsWUFBYyxFQUFBRCxtQkFBbUJqSCxPQUFPYSxPQUdqRCxZQUFBa0YsT0FBQSxTQUFPN0UsRUFBY0MsR0FDakJOLEtBQUtxRyxZQUFZbkIsT0FBTzdFLEVBQU1DLElBR2xDLFlBQUEyQixnQkFBQSxTQUFnQnlELEdBQ1osSUFBSVksRUFBU3RHLEtBQUttQyxNQUFNaEQsT0FBT3VHLEdBQy9CLElBQWUsSUFBWFksRUFDQSxNQUFNLElBQUlDLE1BQU0sOEJBQThCYixFQUFPdEcsS0FFekQsT0FBT2tILEdBRWYsRUF4QkEsQ0FBMkJwRixPQUFPOEUsT0FBckIsRUFBQUEsUyx3SENIYixXQUNBLE9BQ0EsT0FVQSxhQVlJLFdBQVksRyxJQUFDSyxFQUFXLGNBQUVHLEVBQU8sVUFBRUMsRUFBUSxXQUFFQyxFQUFLLFFBRmxELEtBQUF0QyxNQUFRbEQsT0FBT04sS0FBS3lELFNBQVMsSUFBSyxHQUc5QnJFLEtBQUtxRyxZQUFjQSxFQUNuQnJHLEtBQUt3RyxRQUFVQSxFQUNmeEcsS0FBSzBHLE1BQVFBLEVBRWIxRyxLQUFLMkcsR0FBSyxDQUFDRixFQUFTRyxPQUFPLE1BQU9ILEVBQVNHLE9BQU8sTUFDbEQ1RyxLQUFLNkcsS0FBTyxDQUFDSixFQUFTRyxPQUFPLFFBQVNILEVBQVNHLE9BQU8sTUFDdEQ1RyxLQUFLOEcsT0FBUyxDQUFDTCxFQUFTRyxPQUFPLFFBQVNILEVBQVNHLE9BQU8sTUFDeEQ1RyxLQUFLK0csTUFBUSxDQUFDTixFQUFTRyxPQUFPLFNBQVVILEVBQVNHLE9BQU8sTUFXaEUsT0FSSSxZQUFBMUIsT0FBQSxTQUFPN0UsRUFBY0MsR0FDakJOLEtBQUt3RyxRQUFRdEIsT0FBTzdFLEVBQU1DLEdBRTFCTixLQUFLcUcsWUFBWTlGLEdBQUtELEVBQVFOLEtBQUtvRSxPQUFTNEMsT0FBT2hILEtBQUsrRyxNQUFNRSxNQUFLLFNBQUExRyxHQUFLLE9BQUFBLEVBQUUyRyxXQUFXRixPQUFPaEgsS0FBSzZHLEtBQUtJLE1BQUssU0FBQTFHLEdBQUssT0FBQUEsRUFBRTJHLFlBQ2xIbEgsS0FBS3FHLFlBQVk3RixHQUFLRixFQUFRTixLQUFLb0UsT0FBUzRDLE9BQU9oSCxLQUFLOEcsT0FBT0csTUFBSyxTQUFBMUcsR0FBSyxPQUFBQSxFQUFFMkcsV0FBV0YsT0FBT2hILEtBQUsyRyxHQUFHTSxNQUFLLFNBQUExRyxHQUFLLE9BQUFBLEVBQUUyRyxZQUVqSGxILEtBQUtxRyxZQUFZdEIsWUFBWTdELE9BQU9OLEtBQUtpRSxNQUFNQyxRQUFROUUsS0FBSzBHLE1BQU1uRyxFQUFHUCxLQUFLMEcsTUFBTWxHLEVBQUdSLEtBQUtxRyxZQUFZOUYsRUFBR1AsS0FBS3FHLFlBQVk3RixHQUFLSSxLQUFLdUcsR0FBSyxJQUUvSSxFQS9CQSxHQUFhLEVBQUFDLGNBaUNiLCtCQWlCQSxPQWRXLEVBQUE1RixLQUFQLFNBQVlDLEdBQ1IsRUFBQWYsY0FBY2MsS0FBS0MsR0FDbkIsRUFBQThCLGlCQUFpQi9CLEtBQUtDLEdBQ3RCQSxFQUFNRCxLQUFLRSxNQUFNMEUsRUFBbUJpQixrQkFBbUIsMkJBR3BELEVBQUFsSSxPQUFQLFNBQWNzQyxHQUNWLElBQU1nRixFQUFXaEYsRUFBTTZGLE1BQU1iLFNBQ3ZCQyxFQUFRakYsRUFBTTZGLE1BQU1DLGFBQ3BCRixFQUFvQjVGLEVBQU1hLElBQUl2QixPQUFPLEVBQUcsRUFBR3FGLEVBQW1CaUIsbUJBQzlEaEIsRUFBYzVFLEVBQU1hLElBQUlQLFVBQVUsSUFBSyxJQUFLLENBQUNzRixJQUFvQkcsU0FBUyxHQUMxRWhCLEVBQVUsRUFBQWlCLHlCQUF5QnRJLE9BQU9zQyxFQUFPNEUsR0FDdkQsT0FBTyxJQUFJZSxFQUFZLENBQUNmLFlBQVcsRUFBRUcsUUFBTyxFQUFFQyxTQUFRLEVBQUVDLE1BQUssS0FkakQsRUFBQVcsa0JBQW9CLG9CQWdCeEMsRUFqQkEsR0FBYSxFQUFBakIsc0IscUlDN0NiLFdBRUEsT0FVQSxhQU1JLFdBQVksR0FBWixXQUFhdkcsRUFBTSxTQUFFMEMsRUFBUyxZQUFFK0UsRUFBSyxRQUFFWixFQUFLLFFBSjVDLEtBQUFnQixZQUFjLEVBb0JkLEtBQUFDLFVBQVksV0FBTSxTQUFLbkIsUUFBUSxFQUFLa0IsY0FFcEMsS0FBQUUsY0FBZ0IsV0FDWixFQUFLRCxZQUFZMUgsYUFBWSxHQUM3QixFQUFLNEgsY0FDTCxFQUFLRixZQUFZMUgsYUFBWSxJQXBCN0JELEtBQUt3RyxRQUFVLENBQUMzRyxFQUFRMEMsR0FDeEJ2QyxLQUFLMEcsTUFBUUEsRUFFYlksRUFBTWIsU0FBU0csT0FBTyxLQUFLa0IsR0FBRzVHLE9BQU82RyxNQUFNQyxTQUFTNUcsT0FBTzZHLEtBQU1qSSxLQUFLNEgsZUFDdEVOLEVBQU1iLFNBQVNHLE9BQU8sUUFBUWtCLEdBQUc1RyxPQUFPNkcsTUFBTUMsU0FBUzVHLE9BQU82RyxLQUFNakksS0FBSzRILGVBRXpFNUgsS0FBSzJILFlBQVkxSCxhQUFZLEdBcUJyQyxPQWxCSSxZQUFBaUYsT0FBQSxTQUFPN0UsRUFBY0MsR0FDYk4sS0FBSzBHLE1BQU1RLFFBQ1hsSCxLQUFLMkgsWUFBWXZILEtBQUtDLEVBQU1DLEVBQU9OLEtBQUswRyxNQUFNbkcsRUFBR1AsS0FBSzBHLE1BQU1sRyxJQVlwRSxZQUFBcUgsWUFBQSxhQUNVN0gsS0FBSzBILGFBQWUxSCxLQUFLd0csUUFBUTBCLFNBQ25DbEksS0FBSzBILFlBQWMsSUFFL0IsRUFsQ0EsR0FBYSxFQUFBUyxxQkFvQ2IsK0JBUUEsT0FQVyxFQUFBaEosT0FBUCxTQUFjc0MsRUFBY00sR0FDeEIsSUFBTXVGLEVBQVE3RixFQUFNNkYsTUFDZFosRUFBUWpGLEVBQU02RixNQUFNQyxhQUNwQjFILEVBQVMsRUFBQWEsY0FBY3ZCLE9BQU9zQyxFQUFPTSxHQUNyQ1EsRUFBWSxFQUFBZ0IsaUJBQWlCcEUsT0FBT3NDLEVBQU9NLEdBQ2pELE9BQU8sSUFBSW9HLEVBQW1CLENBQUN0SSxPQUFNLEVBQUUwQyxVQUFTLEVBQUUrRSxNQUFLLEVBQUVaLE1BQUssS0FFdEUsRUFSQSxHQUFhLEVBQUFlIiwiZmlsZSI6ImdhbWUuYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDMpO1xuIiwiaW1wb3J0IHsgUGFpckZhY3RvcnkgfSBmcm9tIFwibWF0dGVyXCI7XHJcbmltcG9ydCB7IElNYW5kYWxvcmlhbldlYXBvbiB9IGZyb20gXCIuL01hbmRhbG9yaWFuV2VhcG9uc1wiO1xyXG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gXCIuL1NjZW5lXCI7XHJcblxyXG5pbnRlcmZhY2UgSVBhcmFtcyB7XHJcbiAgICBwaXN0b2w6IFBoYXNlci5HYW1lT2JqZWN0cy5TcHJpdGU7XHJcbiAgICBvYmplY3RGYWN0b3J5OiBQaGFzZXIuR2FtZU9iamVjdHMuR2FtZU9iamVjdEZhY3Rvcnk7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBQaXN0b2wgaW1wbGVtZW50cyBJTWFuZGFsb3JpYW5XZWFwb24ge1xyXG4gICAgcGlzdG9sOiBQaGFzZXIuR2FtZU9iamVjdHMuU3ByaXRlO1xyXG4gICAgb2JqZWN0RmFjdG9yeTogUGhhc2VyLkdhbWVPYmplY3RzLkdhbWVPYmplY3RGYWN0b3J5O1xyXG4gICAgbGFzdEZpcmVkID0gMDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih7cGlzdG9sLCBvYmplY3RGYWN0b3J5fSA6IElQYXJhbXMpIHtcclxuICAgICAgICB0aGlzLnBpc3RvbCA9IHBpc3RvbDtcclxuICAgICAgICB0aGlzLm9iamVjdEZhY3RvcnkgPSBvYmplY3RGYWN0b3J5O1xyXG4gICAgfVxyXG5cclxuICAgIHNldEFjdGl2YXRlKGFjdGl2YXRlZDogYm9vbGVhbikge1xyXG4gICAgICAgIHRoaXMucGlzdG9sLnNldFZpc2libGUoYWN0aXZhdGVkKTtcclxuICAgIH1cclxuXHJcbiAgICBmaXJlKHRpbWU6IG51bWJlciwgZGVsdGE6IG51bWJlciwgeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGltZSA+IHRoaXMubGFzdEZpcmVkKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHNwcml0ZU5hbWUgPSBQaXN0b2xGYWN0b3J5LnNob3RTcHJpdGVzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDUpXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHNob3RTcHJpdGUgPSB0aGlzLm9iamVjdEZhY3Rvcnkuc3ByaXRlKHgsIHksIHNwcml0ZU5hbWUpO1xyXG4gICAgICAgICAgICBzaG90U3ByaXRlLnBsYXkoc3ByaXRlTmFtZSk7XHJcbiAgICAgICAgICAgIHNob3RTcHJpdGUub25jZShQaGFzZXIuQW5pbWF0aW9ucy5FdmVudHMuU1BSSVRFX0FOSU1BVElPTl9DT01QTEVURSwgKCkgPT4gc2hvdFNwcml0ZS5kZXN0cm95KCkpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5sYXN0RmlyZWQgPSB0aW1lICsgODAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFBpc3RvbEZhY3Rvcnkge1xyXG4gICAgc3RhdGljIHJlYWRvbmx5IHBpc3RvbCA9ICdhc3NldHMvcGlzdG9sLnBuZyc7XHJcblxyXG4gICAgc3RhdGljIHJlYWRvbmx5IHNob3RTcHJpdGVzID0gW1xyXG4gICAgICAgICdhc3NldHMvcGlzdG9sLXNob3QucG5nJyxcclxuICAgICAgICAnYXNzZXRzL3Bpc3RvbC1zaG90LXVwLnBuZycsXHJcbiAgICAgICAgJ2Fzc2V0cy9waXN0b2wtc2hvdC1yaWdodC5wbmcnLFxyXG4gICAgICAgICdhc3NldHMvcGlzdG9sLXNob3QtYm90dG9tLnBuZycsXHJcbiAgICAgICAgJ2Fzc2V0cy9waXN0b2wtc2hvdC1sZWZ0LnBuZydcclxuICAgIF07XHJcblxyXG4gICAgc3RhdGljIGxvYWQoc2NlbmU6IFNjZW5lKSB7XHJcbiAgICAgICAgc2NlbmUubG9hZC5pbWFnZShQaXN0b2xGYWN0b3J5LnBpc3RvbCwgUGlzdG9sRmFjdG9yeS5waXN0b2wpO1xyXG5cclxuICAgICAgICBmb3IgKHZhciBzcHJpdGUgb2YgUGlzdG9sRmFjdG9yeS5zaG90U3ByaXRlcylcclxuICAgICAgICAgICAgc2NlbmUubG9hZC5zcHJpdGVzaGVldChzcHJpdGUsIHNwcml0ZSwgeyBmcmFtZVdpZHRoOiAzMiwgZnJhbWVIZWlnaHQ6IDMyLCBlbmRGcmFtZTogMyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgY3JlYXRlKHNjZW5lOiBTY2VuZSwgY29udGFpbmVyOiBQaGFzZXIuR2FtZU9iamVjdHMuQ29udGFpbmVyKSB7XHJcbiAgICAgICAgUGlzdG9sRmFjdG9yeS5zaG90U3ByaXRlcy5tYXAoc3ByaXRlID0+IHNjZW5lLmNyZWF0ZUFuaW1hdGlvbih7XHJcbiAgICAgICAgICAgIGtleTogc3ByaXRlLFxyXG4gICAgICAgICAgICBmcmFtZXM6IHNjZW5lLmFuaW1zLmdlbmVyYXRlRnJhbWVOYW1lcyhzcHJpdGUpLFxyXG4gICAgICAgICAgICBoaWRlT25Db21wbGV0ZTogdHJ1ZSxcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHBpc3RvbCA9IHNjZW5lLmFkZC5zcHJpdGUoMTIsIC0xMCwgUGlzdG9sRmFjdG9yeS5waXN0b2wpLnNldFZpc2libGUoZmFsc2UpO1xyXG4gICAgICAgIGNvbnRhaW5lci5hZGQocGlzdG9sKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBQaXN0b2woe29iamVjdEZhY3Rvcnk6IHNjZW5lLmFkZCwgcGlzdG9sfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSU1hbmRhbG9yaWFuV2VhcG9uIH0gZnJvbSBcIi4vTWFuZGFsb3JpYW5XZWFwb25zXCI7XHJcbmltcG9ydCB7IFJvY2tldCB9IGZyb20gXCIuL1JvY2tldFwiO1xyXG5pbXBvcnQgeyBTY2VuZSB9IGZyb20gXCIuL1NjZW5lXCI7XHJcblxyXG5pbnRlcmZhY2UgSVBhcmFtcyB7XHJcbiAgICByb2NrZXRHdW46IFBoYXNlci5HYW1lT2JqZWN0cy5TcHJpdGU7XHJcbiAgICByb2NrZXRHcm91cDogUGhhc2VyLkdhbWVPYmplY3RzLkdyb3VwO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgUm9ja2V0R3VuIGltcGxlbWVudHMgSU1hbmRhbG9yaWFuV2VhcG9uIHtcclxuICAgIHN0YXRpYyB0ZW1wTWF0cml4ID0gbmV3IFBoYXNlci5HYW1lT2JqZWN0cy5Db21wb25lbnRzLlRyYW5zZm9ybU1hdHJpeCgpO1xyXG5cclxuICAgIHJvY2tldEd1bjogUGhhc2VyLkdhbWVPYmplY3RzLlNwcml0ZTtcclxuICAgIHJvY2tldEdyb3VwOiBQaGFzZXIuR2FtZU9iamVjdHMuR3JvdXA7XHJcbiAgICBsYXN0RmlyZWQgPSAwO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHtyb2NrZXRHdW4sIHJvY2tldEdyb3VwfSA6IElQYXJhbXMpIHtcclxuICAgICAgICB0aGlzLnJvY2tldEd1biA9IHJvY2tldEd1bjtcclxuICAgICAgICB0aGlzLnJvY2tldEdyb3VwID0gcm9ja2V0R3JvdXA7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QWN0aXZhdGUoYWN0aXZhdGVkOiBib29sZWFuKSB7XHJcbiAgICAgICAgdGhpcy5yb2NrZXRHdW4uc2V0VmlzaWJsZShhY3RpdmF0ZWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZpcmUodGltZTogbnVtYmVyLCBkZWx0YTogbnVtYmVyLCB4OiBudW1iZXIsIHk6IG51bWJlcikge1xyXG4gICAgICAgIGlmICh0aW1lID4gdGhpcy5sYXN0RmlyZWQpIHtcclxuICAgICAgICAgICAgdmFyIHJvY2tldCA9IHRoaXMucm9ja2V0R3JvdXAuZ2V0KCkgYXMgUm9ja2V0O1xyXG5cclxuICAgICAgICAgICAgaWYgKHJvY2tldCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgW3gwLCB5MF0gPSB0aGlzLmdldEFic29sdXRlUG9zaXRpb24oKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgcm9ja2V0LmFjdGl2YXRlKHgwLCB5MCwgeCwgeSk7XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0RmlyZWQgPSB0aW1lICsgNjAwO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldEFic29sdXRlUG9zaXRpb24oKSB7XHJcbiAgICAgICAgdGhpcy5yb2NrZXRHdW4uZ2V0V29ybGRUcmFuc2Zvcm1NYXRyaXgoUm9ja2V0R3VuLnRlbXBNYXRyaXgpO1xyXG4gICAgICAgIHZhciBkID0gUm9ja2V0R3VuLnRlbXBNYXRyaXguZGVjb21wb3NlTWF0cml4KCkgYXMgYW55OyAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIFtkLnRyYW5zbGF0ZVgsIGQudHJhbnNsYXRlWV1cclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIFJvY2tldEd1bkZhY3Rvcnkge1xyXG4gICAgc3RhdGljIHJlYWRvbmx5IGltYWdlID0gJ2Fzc2V0cy9yb2NrZXQtZ3VuLnBuZyc7XHJcblxyXG4gICAgc3RhdGljIGxvYWQoc2NlbmU6IFNjZW5lKSB7XHJcbiAgICAgICAgc2NlbmUubG9hZC5pbWFnZSh7XHJcbiAgICAgICAgICAgIGtleTogUm9ja2V0R3VuRmFjdG9yeS5pbWFnZSxcclxuICAgICAgICAgICAgdXJsOiBSb2NrZXRHdW5GYWN0b3J5LmltYWdlLFxyXG4gICAgICAgIH0pOyAgICAgICAgXHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGNyZWF0ZShzY2VuZTogU2NlbmUsIGNvbnRhaW5lcjogUGhhc2VyLkdhbWVPYmplY3RzLkNvbnRhaW5lcikge1xyXG4gICAgICAgIGNvbnN0IHJvY2tldEdyb3VwID0gc2NlbmUuYWRkLmdyb3VwKHtcclxuICAgICAgICAgICAgY2xhc3NUeXBlOiBSb2NrZXQsXHJcbiAgICAgICAgICAgIG1heFNpemU6IDIwLFxyXG4gICAgICAgICAgICBydW5DaGlsZFVwZGF0ZTogdHJ1ZVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCByb2NrZXRHdW4gPSBzY2VuZS5hZGQuc3ByaXRlKDEyLCAtNywgUm9ja2V0R3VuRmFjdG9yeS5pbWFnZSkuc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgY29udGFpbmVyLmFkZChyb2NrZXRHdW4pO1xyXG5cclxuXHJcbiAgICAgICAgcmV0dXJuIG5ldyBSb2NrZXRHdW4oe3JvY2tldEd1biwgcm9ja2V0R3JvdXB9KTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTY2VuZSB9IGZyb20gXCIuL1NjZW5lXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUm9ja2V0IGV4dGVuZHMgUGhhc2VyLkdhbWVPYmplY3RzLkltYWdlIHtcclxuICAgIGluY1g6IG51bWJlcjtcclxuICAgIGluY1k6IG51bWJlcjtcclxuICAgIHgxOiBudW1iZXI7XHJcbiAgICB5MTogbnVtYmVyO1xyXG4gICAgeDI6IG51bWJlcjtcclxuICAgIHkyOiBudW1iZXI7XHJcbiAgICBzcGVlZDogbnVtYmVyO1xyXG4gICAgYm9vbVNwcml0ZTogUGhhc2VyLkdhbWVPYmplY3RzLlNwcml0ZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihzY2VuZTogU2NlbmUpIHtcclxuICAgICAgICBzdXBlcihzY2VuZSwgMCwgMCwgUm9ja2V0RmFjdG9yeS5yb2NrZXRJbWFnZSk7XHJcblxyXG4gICAgICAgIHRoaXMuZGlzcGxheUhlaWdodCA9IDc7XHJcbiAgICAgICAgdGhpcy5kaXNwbGF5V2lkdGggPSAxNTtcclxuICAgICAgICB0aGlzLmluY1ggPSAwO1xyXG4gICAgICAgIHRoaXMuaW5jWSA9IDA7XHJcbiAgICAgICAgdGhpcy5zcGVlZCA9IFBoYXNlci5NYXRoLkdldFNwZWVkKDQwMCwgMSk7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGFjdGl2YXRlKHgxOiBudW1iZXIsIHkxOiBudW1iZXIsIHgyOiBudW1iZXIsIHkyOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLngxID0geDE7XHJcbiAgICAgICAgdGhpcy55MSA9IHkxO1xyXG4gICAgICAgIHRoaXMueDIgPSB4MjtcclxuICAgICAgICB0aGlzLnkyID0geTI7XHJcblxyXG4gICAgICAgIHRoaXMuc2V0QWN0aXZlKHRydWUpO1xyXG4gICAgICAgIHRoaXMuc2V0VmlzaWJsZSh0cnVlKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbih4MSwgeTEpO1xyXG5cclxuICAgICAgICB2YXIgYW5nbGUgPSBQaGFzZXIuTWF0aC5BbmdsZS5CZXR3ZWVuKHgyLCB5MiwgeDEsIHkxKTtcclxuXHJcbiAgICAgICAgdGhpcy5zZXRSb3RhdGlvbihhbmdsZSk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5jWCA9IE1hdGguY29zKGFuZ2xlKTtcclxuICAgICAgICB0aGlzLmluY1kgPSBNYXRoLnNpbihhbmdsZSk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKHRpbWU6IG51bWJlciwgZGVsdGE6IG51bWJlcikge1xyXG5cclxuICAgICAgICB0aGlzLnggLT0gdGhpcy5pbmNYICogKHRoaXMuc3BlZWQgKiBkZWx0YSk7XHJcbiAgICAgICAgdGhpcy55IC09IHRoaXMuaW5jWSAqICh0aGlzLnNwZWVkICogZGVsdGEpO1xyXG5cclxuICAgICAgICBpZiAoTWF0aC5hYnModGhpcy54MiAtIHRoaXMueDEpIC0gTWF0aC5hYnModGhpcy54IC0gdGhpcy54MSkgPCAwIHx8XHJcbiAgICAgICAgICAgIE1hdGguYWJzKHRoaXMueTIgLSB0aGlzLnkxKSAtIE1hdGguYWJzKHRoaXMueSAtIHRoaXMueTEpIDwgMCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldEFjdGl2ZShmYWxzZSk7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0VmlzaWJsZShmYWxzZSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBleHBsb3Npb25TcHJpdGUgPSB0aGlzLnNjZW5lLmFkZC5zcHJpdGUodGhpcy54LCB0aGlzLnksIFJvY2tldEZhY3RvcnkuZXhwbG9zaW9uU3ByaXRlKTsgICAgICAgICAgICBcclxuICAgICAgICAgICAgZXhwbG9zaW9uU3ByaXRlLnNldFNjYWxlKDEwKVxyXG4gICAgICAgICAgICBleHBsb3Npb25TcHJpdGUucGxheShSb2NrZXRGYWN0b3J5LmV4cGxvc2lvblNwcml0ZSk7XHJcbiAgICAgICAgICAgIGV4cGxvc2lvblNwcml0ZS5vbmNlKFBoYXNlci5BbmltYXRpb25zLkV2ZW50cy5TUFJJVEVfQU5JTUFUSU9OX0NPTVBMRVRFLCAoKSA9PiBleHBsb3Npb25TcHJpdGUuZGVzdHJveSgpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHRoaXMuZGVzdHJveSgpO1xyXG5cclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rlc3Ryb3knKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBSb2NrZXRGYWN0b3J5IHtcclxuICAgIHN0YXRpYyByZWFkb25seSByb2NrZXRJbWFnZSA9ICdhc3NldHMvcm9ja2V0LnBuZyc7XHJcbiAgICBzdGF0aWMgcmVhZG9ubHkgZXhwbG9zaW9uU3ByaXRlID0gJ2Fzc2V0cy9yb2NrZXQtZXhwbG9zaW9uLnBuZyc7XHJcblxyXG4gICAgc3RhdGljIGxvYWQoc2NlbmU6IFNjZW5lKSB7XHJcbiAgICAgICAgc2NlbmUubG9hZC5pbWFnZSh7XHJcbiAgICAgICAgICAgIGtleTogUm9ja2V0RmFjdG9yeS5yb2NrZXRJbWFnZSxcclxuICAgICAgICAgICAgdXJsOiBSb2NrZXRGYWN0b3J5LnJvY2tldEltYWdlLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBzY2VuZS5sb2FkLnNwcml0ZXNoZWV0KFJvY2tldEZhY3RvcnkuZXhwbG9zaW9uU3ByaXRlLCBSb2NrZXRGYWN0b3J5LmV4cGxvc2lvblNwcml0ZSwgeyBmcmFtZVdpZHRoOiA2NCwgZnJhbWVIZWlnaHQ6IDY0LCBlbmRGcmFtZTogMjMgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGFkZEFuaW1hdGlvblRvU2NlbmUoc2NlbmU6IFNjZW5lKSB7XHJcbiAgICAgICAgcmV0dXJuIHNjZW5lLmFuaW1zLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIGtleTogUm9ja2V0RmFjdG9yeS5leHBsb3Npb25TcHJpdGUsXHJcbiAgICAgICAgICAgIGZyYW1lczogc2NlbmUuYW5pbXMuZ2VuZXJhdGVGcmFtZU5hbWVzKFJvY2tldEZhY3RvcnkuZXhwbG9zaW9uU3ByaXRlKSxcclxuICAgICAgICAgICAgaGlkZU9uQ29tcGxldGU6IHRydWUsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCAncGhhc2VyJztcclxuaW1wb3J0IHtTY2VuZX0gZnJvbSAnLi9TY2VuZSc7XHJcblxyXG5jb25zdCBjb25maWcgPSB7XHJcbiAgICB0eXBlOiBQaGFzZXIuV0VCR0wsXHJcbiAgICB3aWR0aDogODAwLFxyXG4gICAgaGVpZ2h0OiA2MDAsXHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I6ICcjMmQyZDJkJyxcclxuICAgIHNjZW5lOiBTY2VuZVxyXG59O1xyXG5cclxuY29uc3QgZ2FtZSA9IG5ldyBQaGFzZXIuR2FtZShjb25maWcpO1xyXG4iLCJtb2R1bGUuZXhwb3J0cyA9IChfX3dlYnBhY2tfcmVxdWlyZV9fKDUpKSgxKTsiLCJtb2R1bGUuZXhwb3J0cyA9IHZlbmRvcjsiLCJpbXBvcnQgeyBNYW5kYWxvcmlhbiwgTWFuZGFsb3JpYW5GYWN0b3J5IH0gZnJvbSAnLi9NYW5kYWxvcmlhbic7XHJcbmltcG9ydCB7IFJvY2tldEZhY3RvcnkgfSBmcm9tICcuL1JvY2tldCc7XHJcblxyXG5leHBvcnQgY2xhc3MgU2NlbmUgZXh0ZW5kcyBQaGFzZXIuU2NlbmUgeyAgICBcclxuICAgIG1hbmRhbG9yaWFuOiBNYW5kYWxvcmlhbjtcclxuXHJcbiAgICBwcmVsb2FkKCkgeyAgICAgICAgXHJcbiAgICAgICAgUm9ja2V0RmFjdG9yeS5sb2FkKHRoaXMpO1xyXG4gICAgICAgIE1hbmRhbG9yaWFuRmFjdG9yeS5sb2FkKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGNyZWF0ZSgpIHtcclxuICAgICAgICBSb2NrZXRGYWN0b3J5LmFkZEFuaW1hdGlvblRvU2NlbmUodGhpcyk7XHJcbiAgICAgICAgdGhpcy5tYW5kYWxvcmlhbiA9IE1hbmRhbG9yaWFuRmFjdG9yeS5jcmVhdGUodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlKHRpbWU6IG51bWJlciwgZGVsdGE6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMubWFuZGFsb3JpYW4udXBkYXRlKHRpbWUsIGRlbHRhKTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVBbmltYXRpb24oY29uZmlnOiBQaGFzZXIuVHlwZXMuQW5pbWF0aW9ucy5BbmltYXRpb24pIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5hbmltcy5jcmVhdGUoY29uZmlnKTtcclxuICAgICAgICBpZiAocmVzdWx0ID09PSBmYWxzZSlcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGDQndC1INGD0LTQsNC70L7RgdGMINGB0L7Qt9Cw0YLRjCDQsNC90LjQvNCw0YbQuNGOICR7Y29uZmlnLmtleX1gKVxyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgTWFuZGFsb3JpYW5XZWFwb25GYWN0b3J5LCBNYW5kYWxvcmlhbldlYXBvbnMgfSBmcm9tIFwiLi9NYW5kYWxvcmlhbldlYXBvbnNcIjtcclxuaW1wb3J0IHsgUGlzdG9sRmFjdG9yeSB9IGZyb20gXCIuL1Bpc3RvbFwiO1xyXG5pbXBvcnQgeyBSb2NrZXRHdW5GYWN0b3J5IH0gZnJvbSBcIi4vUm9ja2V0R3VuXCI7XHJcbmltcG9ydCB7IFNjZW5lIH0gZnJvbSBcIi4vU2NlbmVcIjtcclxuXHJcbmludGVyZmFjZSBJUGFyYW1zIHtcclxuICAgIG1hbmRhbG9yaWFuOiBQaGFzZXIuR2FtZU9iamVjdHMuQ29udGFpbmVyOyBcclxuICAgIHdlYXBvbnM6IE1hbmRhbG9yaWFuV2VhcG9ucztcclxuICAgIGtleWJvYXJkOiBQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5Ym9hcmRQbHVnaW47XHJcbiAgICBtb3VzZTogUGhhc2VyLklucHV0LlBvaW50ZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNYW5kYWxvcmlhbiB7XHJcbiAgICBtYW5kYWxvcmlhbjogUGhhc2VyLkdhbWVPYmplY3RzLkNvbnRhaW5lcjtcclxuICAgIHdlYXBvbnM6IE1hbmRhbG9yaWFuV2VhcG9ucztcclxuICAgIG1vdXNlOiBQaGFzZXIuSW5wdXQuUG9pbnRlcjtcclxuXHJcbiAgICB1cDogUGhhc2VyLklucHV0LktleWJvYXJkLktleVtdO1xyXG4gICAgbGVmdDogUGhhc2VyLklucHV0LktleWJvYXJkLktleVtdO1xyXG4gICAgYm90dG9tOiBQaGFzZXIuSW5wdXQuS2V5Ym9hcmQuS2V5W107XHJcbiAgICByaWdodDogUGhhc2VyLklucHV0LktleWJvYXJkLktleVtdO1xyXG5cclxuICAgIHNwZWVkID0gUGhhc2VyLk1hdGguR2V0U3BlZWQoMTAwLCAxKTtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih7bWFuZGFsb3JpYW4sIHdlYXBvbnMsIGtleWJvYXJkLCBtb3VzZX06IElQYXJhbXMpIHtcclxuICAgICAgICB0aGlzLm1hbmRhbG9yaWFuID0gbWFuZGFsb3JpYW47XHJcbiAgICAgICAgdGhpcy53ZWFwb25zID0gd2VhcG9ucztcclxuICAgICAgICB0aGlzLm1vdXNlID0gbW91c2U7XHJcblxyXG4gICAgICAgIHRoaXMudXAgPSBba2V5Ym9hcmQuYWRkS2V5KCd1cCcpLCBrZXlib2FyZC5hZGRLZXkoJ0UnKV07XHJcbiAgICAgICAgdGhpcy5sZWZ0ID0gW2tleWJvYXJkLmFkZEtleSgnbGVmdCcpLCBrZXlib2FyZC5hZGRLZXkoJ1MnKV07XHJcbiAgICAgICAgdGhpcy5ib3R0b20gPSBba2V5Ym9hcmQuYWRkS2V5KCdkb3duJyksIGtleWJvYXJkLmFkZEtleSgnRCcpXTtcclxuICAgICAgICB0aGlzLnJpZ2h0ID0gW2tleWJvYXJkLmFkZEtleSgncmlnaHQnKSwga2V5Ym9hcmQuYWRkS2V5KCdGJyldO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZSh0aW1lOiBudW1iZXIsIGRlbHRhOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLndlYXBvbnMudXBkYXRlKHRpbWUsIGRlbHRhKTtcclxuXHJcbiAgICAgICAgdGhpcy5tYW5kYWxvcmlhbi54ICs9IGRlbHRhICogdGhpcy5zcGVlZCAqIChOdW1iZXIodGhpcy5yaWdodC5zb21lKHggPT4geC5pc0Rvd24pKSAtIE51bWJlcih0aGlzLmxlZnQuc29tZSh4ID0+IHguaXNEb3duKSkpO1xyXG4gICAgICAgIHRoaXMubWFuZGFsb3JpYW4ueSArPSBkZWx0YSAqIHRoaXMuc3BlZWQgKiAoTnVtYmVyKHRoaXMuYm90dG9tLnNvbWUoeCA9PiB4LmlzRG93bikpIC0gTnVtYmVyKHRoaXMudXAuc29tZSh4ID0+IHguaXNEb3duKSkpO1xyXG5cclxuICAgICAgICB0aGlzLm1hbmRhbG9yaWFuLnNldFJvdGF0aW9uKFBoYXNlci5NYXRoLkFuZ2xlLkJldHdlZW4odGhpcy5tb3VzZS54LCB0aGlzLm1vdXNlLnksIHRoaXMubWFuZGFsb3JpYW4ueCwgdGhpcy5tYW5kYWxvcmlhbi55KSAtIE1hdGguUEkgLyAyKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1hbmRhbG9yaWFuRmFjdG9yeSB7XHJcbiAgICBzdGF0aWMgcmVhZG9ubHkgbWFuZGFsb3JpYW5TcHJpdGUgPSAnbWFuZGFsb3JpYW5TcHJpdGUnXHJcblxyXG4gICAgc3RhdGljIGxvYWQoc2NlbmU6IFNjZW5lKSB7XHJcbiAgICAgICAgUGlzdG9sRmFjdG9yeS5sb2FkKHNjZW5lKTtcclxuICAgICAgICBSb2NrZXRHdW5GYWN0b3J5LmxvYWQoc2NlbmUpO1xyXG4gICAgICAgIHNjZW5lLmxvYWQuaW1hZ2UoTWFuZGFsb3JpYW5GYWN0b3J5Lm1hbmRhbG9yaWFuU3ByaXRlLCAnYXNzZXRzL21hbmRhbG9yaWFuLnBuZycpO1xyXG4gICAgfVxyXG5cclxuICAgIHN0YXRpYyBjcmVhdGUoc2NlbmU6IFNjZW5lKSB7XHJcbiAgICAgICAgY29uc3Qga2V5Ym9hcmQgPSBzY2VuZS5pbnB1dC5rZXlib2FyZDtcclxuICAgICAgICBjb25zdCBtb3VzZSA9IHNjZW5lLmlucHV0Lm1vdXNlUG9pbnRlcjtcclxuICAgICAgICBjb25zdCBtYW5kYWxvcmlhblNwcml0ZSA9IHNjZW5lLmFkZC5zcHJpdGUoMCwgMCwgTWFuZGFsb3JpYW5GYWN0b3J5Lm1hbmRhbG9yaWFuU3ByaXRlKTtcclxuICAgICAgICBjb25zdCBtYW5kYWxvcmlhbiA9IHNjZW5lLmFkZC5jb250YWluZXIoNDAwLCA0MDAsIFttYW5kYWxvcmlhblNwcml0ZV0pLnNldERlcHRoKDEpOyAgICAgICAgXHJcbiAgICAgICAgY29uc3Qgd2VhcG9ucyA9IE1hbmRhbG9yaWFuV2VhcG9uRmFjdG9yeS5jcmVhdGUoc2NlbmUsIG1hbmRhbG9yaWFuKTtcclxuICAgICAgICByZXR1cm4gbmV3IE1hbmRhbG9yaWFuKHttYW5kYWxvcmlhbiwgd2VhcG9ucywga2V5Ym9hcmQsIG1vdXNlfSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQaXN0b2wsIFBpc3RvbEZhY3RvcnkgfSBmcm9tIFwiLi9QaXN0b2xcIjtcclxuaW1wb3J0IHsgUm9ja2V0RmFjdG9yeSB9IGZyb20gXCIuL1JvY2tldFwiO1xyXG5pbXBvcnQgeyBSb2NrZXRHdW4sIFJvY2tldEd1bkZhY3RvcnkgfSBmcm9tIFwiLi9Sb2NrZXRHdW5cIjtcclxuaW1wb3J0IHsgU2NlbmUgfSBmcm9tIFwiLi9TY2VuZVwiO1xyXG5cclxuaW50ZXJmYWNlIElQYXJhbXMge1xyXG4gICAgcGlzdG9sOiBQaXN0b2w7XHJcbiAgICByb2NrZXRHdW46IFJvY2tldEd1bjtcclxuICAgIGlucHV0OiBQaGFzZXIuSW5wdXQuSW5wdXRQbHVnaW47XHJcbiAgICBtb3VzZTogUGhhc2VyLklucHV0LlBvaW50ZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNYW5kYWxvcmlhbldlYXBvbnMge1xyXG4gICAgd2VhcG9uczogSU1hbmRhbG9yaWFuV2VhcG9uW107XHJcbiAgICBhY3RpdmVJbmRleCA9IDA7XHJcbiAgICBpc0F0dGFjazogYm9vbGVhbjtcclxuICAgIG1vdXNlOiBQaGFzZXIuSW5wdXQuUG9pbnRlcjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcih7cGlzdG9sLCByb2NrZXRHdW4sIGlucHV0LCBtb3VzZX0gOiBJUGFyYW1zKSB7XHJcbiAgICAgICAgdGhpcy53ZWFwb25zID0gW3Bpc3RvbCwgcm9ja2V0R3VuXTtcclxuICAgICAgICB0aGlzLm1vdXNlID0gbW91c2U7ICAgICAgICBcclxuXHJcbiAgICAgICAgaW5wdXQua2V5Ym9hcmQuYWRkS2V5KCdXJykub24oUGhhc2VyLklucHV0LktleWJvYXJkLkV2ZW50cy5ET1dOLCB0aGlzLnN3aXRjaFdlYXBvbnMpO1xyXG4gICAgICAgIGlucHV0LmtleWJvYXJkLmFkZEtleSgnQ1RSTCcpLm9uKFBoYXNlci5JbnB1dC5LZXlib2FyZC5FdmVudHMuRE9XTiwgdGhpcy5zd2l0Y2hXZWFwb25zKTtcclxuXHJcbiAgICAgICAgdGhpcy5nZXRXZWFwb24oKS5zZXRBY3RpdmF0ZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGUodGltZTogbnVtYmVyLCBkZWx0YTogbnVtYmVyKSB7XHJcbiAgICAgICAgaWYgKHRoaXMubW91c2UuaXNEb3duKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0V2VhcG9uKCkuZmlyZSh0aW1lLCBkZWx0YSwgdGhpcy5tb3VzZS54LCB0aGlzLm1vdXNlLnkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBnZXRXZWFwb24gPSAoKSA9PiB0aGlzLndlYXBvbnNbdGhpcy5hY3RpdmVJbmRleF07XHJcblxyXG4gICAgc3dpdGNoV2VhcG9ucyA9ICgpID0+IHtcclxuICAgICAgICB0aGlzLmdldFdlYXBvbigpLnNldEFjdGl2YXRlKGZhbHNlKTtcclxuICAgICAgICB0aGlzLnN3aXRjaEluZGV4KCk7XHJcbiAgICAgICAgdGhpcy5nZXRXZWFwb24oKS5zZXRBY3RpdmF0ZSh0cnVlKTtcclxuICAgIH1cclxuXHJcbiAgICBzd2l0Y2hJbmRleCgpIHtcclxuICAgICAgICBpZiAoKyt0aGlzLmFjdGl2ZUluZGV4ID49IHRoaXMud2VhcG9ucy5sZW5ndGgpIFxyXG4gICAgICAgICAgICB0aGlzLmFjdGl2ZUluZGV4ID0gMDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIE1hbmRhbG9yaWFuV2VhcG9uRmFjdG9yeSB7XHJcbiAgICBzdGF0aWMgY3JlYXRlKHNjZW5lOiBTY2VuZSwgY29udGFpbmVyOiBQaGFzZXIuR2FtZU9iamVjdHMuQ29udGFpbmVyKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXQgPSBzY2VuZS5pbnB1dDtcclxuICAgICAgICBjb25zdCBtb3VzZSA9IHNjZW5lLmlucHV0Lm1vdXNlUG9pbnRlcjtcclxuICAgICAgICBjb25zdCBwaXN0b2wgPSBQaXN0b2xGYWN0b3J5LmNyZWF0ZShzY2VuZSwgY29udGFpbmVyKTtcclxuICAgICAgICBjb25zdCByb2NrZXRHdW4gPSBSb2NrZXRHdW5GYWN0b3J5LmNyZWF0ZShzY2VuZSwgY29udGFpbmVyKTsgICAgICAgIFxyXG4gICAgICAgIHJldHVybiBuZXcgTWFuZGFsb3JpYW5XZWFwb25zKHtwaXN0b2wsIHJvY2tldEd1biwgaW5wdXQsIG1vdXNlfSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSU1hbmRhbG9yaWFuV2VhcG9uIHtcclxuICAgIHNldEFjdGl2YXRlKGFjdGl2YXRlZDogYm9vbGVhbik6IHZvaWQ7XHJcbiAgICBmaXJlKHRpbWU6IG51bWJlciwgZGVsdGE6IG51bWJlciwgeDogbnVtYmVyLCB5OiBudW1iZXIpOiB2b2lkO1xyXG59Il0sInNvdXJjZVJvb3QiOiIifQ==